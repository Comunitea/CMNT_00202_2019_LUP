<?xml version="1.0"?>
<odoo>

    <!-- MAIN MENU -->
    <menuitem id="menu_costs_root" name="Hojas de coste" sequence="30"/>

   

    <record id="cost_sheet_view_tree" model="ir.ui.view">
        <field name="name">cost.sheet.view</field>
        <field name="model">cost.sheet</field>
        <field name="arch" type="xml">
            <tree create="false">
                <field name="name"/>
                <field name="sheet_type"/>
                <field name="sale_line_id"/>
                <field name="sale_id"/>
                <field name="production_id"/>
                <field name="price_total"/>
            </tree>
        </field>
    </record>

    <record id="cost_sheet_view_search" model="ir.ui.view">
        <field name="name">cost.sheet.view.search</field>
        <field name="model">cost.sheet</field>
        <field name="arch" type="xml">
            <search>
                <field name="sale_line_id"/>
                <field name="sale_id"/>
                <field name="group_id"/>
                
                <group expand="0" string="Group By">
                    <filter name="group_line"  string="Sale Line"  domain="[]" context="{'group_by':'sale_line_id'}"/>
                    <filter name="group_sale" string="Sale Order" domain="[]" context="{'group_by':'sale_id'}"/>
                    <filter name="group_group" string="Cost Group" domain="[]" context="{'group_by':'group_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="action_cost_sheets" model="ir.actions.act_window">
        <field name="name">Hojas de coste</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">cost.sheet</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
    </record>

    <menuitem id="menu_cost_sheets" name="Costes" parent="menu_costs_root" sequence="10"/>

    <menuitem id="menu_action_cost_sheets" action="action_cost_sheets"  name="Hojas de coste" parent="menu_cost_sheets" sequence="20"/>


    <record id="product_cost_sheet_view_tree" model="ir.ui.view">
        <field name="name">group.cost.sheet.view</field>
        <field name="model">group.cost.sheet</field>
        <field name="arch" type="xml">
            <tree create="false">
                <field name="display_name"/>
                <field name="sale_line_id"/>
                <field name="sale_id"/>
                <field name="line_pvp"/>
            </tree>
        </field>
    </record>

    <record id="product_cost_sheet_view_form" model="ir.ui.view">
        <field name="name">group.cost.sheet.view</field>
        <field name="model">group.cost.sheet</field>
        <field name="arch" type="xml">
            <form create="false">
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="display_name"/>
                        </h1>
                        <h2>
                            <field name="sale_line_id"/>
                        </h2>
                        <h2>
                            <field name="product_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                        </h2>
                        <h3>
                            <field name="sale_id"/>
                        </h3>
                    </div>
                    <group groups="cost_sheet_lupeon.group_cs_manager">
                        <field name="admin_fact"/>
                        <field name="ing_hours"/>
                        <field name="tech_hours"/>
                        <field name="help_hours"/>
                        <field name="km_cost"/>
                    </group>

                     <group>
                        <field name="bom_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                    </group>


                    <group colespan="4" string="Hojas de coste">
                        <field name="sheet_ids" nolabel="1">
                            <tree create="1">
                                <field name="name"/>
                                <field name="sheet_type"/>
                                <field name="sale_line_id"/>
                                <field name="sale_id"/>
                                <field name="production_id"/>
                                <field name="price_total"/>
                                <button name="duplicate_sheet" type="object" string="Duplicate" icon="fa-copy"/>
                            </tree>
                        </field>
                    </group>
                    <group colespan="4" string="Ensamblaje">
                        <field name="assembly_ids" nolabel="1">
                            <tree create="1" editable="bottom">
                                <field name="name"/>
                                <field name="type" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                <field name="time"/>
                                <field name="total"/>
                            </tree>
                        </field>
                    </group>
                    <group class="oe_subtotal_footer oe_right" colspan="2" name="pvp_total">
                        <field name="line_pvp" widget='monetary'/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="product_cost_sheet_view_search" model="ir.ui.view">
        <field name="name">group.cost.sheet.view.search</field>
        <field name="model">group.cost.sheet</field>
        <field name="arch" type="xml">
            <search>
                <field name="sale_line_id"/>
                <field name="product_id"/>
                <field name="product_id"/>
                
                <group expand="0" string="Group By">
                    <filter string="Sale Line" name="group_line" domain="[]" context="{'group_by':'sale_line_id'}"/>
                    <filter name="group_prouct" string="Pedido de venta" domain="[]" context="{'group_by':'sale_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="action_product_cost_sheets" model="ir.actions.act_window">
        <field name="name">Hojas de coste</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">group.cost.sheet</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
    </record>

    <menuitem id="menu_product_cost_sheets" action="action_product_cost_sheets"  name="Grupos de costes" parent="menu_cost_sheets" sequence="1"/>


        <!-- Vistas de campos One2many -->
    <record id="oppi_line_view_tree" model="ir.ui.view">
        <field name="name">oppi_line_view_tree</field>
        <field name="model">oppi.cost.line</field>
        <field name="arch" type="xml">
            <tree editable="bottom">
                <field name="name"/>
                <field name="e_partner_id" options="{'no_create_edit': True, 'no_quick_create': True}" domain="[('supplier', '=', True)]"/>
                <field name="type" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                <field name="t1f"/>
                <field name="time"/>
                <!-- <field name="employee_id"/> -->
                <!-- <field name="task_id"/> -->
                <field name="time_real" widget="float_time"/>
            </tree>
        </field>
    </record>

    <record id="workforce_view_tree" model="ir.ui.view">
        <field name="name">workforce_view_tree</field>
        <field name="model">workforce.cost.line</field>
        <field name="arch" type="xml">
            <tree editable="bottom">
                <field name="name"/>
                <field name="hours"/>
                <field name="minutes"/>
                <field name="euro_unit"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                <field name="total"  groups="cost_sheet_lupeon.group_cs_advanced"/>
            </tree>
        </field>
    </record>

    <record id="workforce_view_form" model="ir.ui.view">
        <field name="name">workforce_view_form</field>
        <field name="model">workforce.cost.line</field>
        <field name="arch" type="xml">
            <form>
                <group>
                    <field name="name"/>
                    <field name="hours"/>
                    <field name="minutes"/>
                    <field name="euro_unit"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                    <field name="total"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                </group>
            </form>
        </field>
    </record>


    <record id="cost_sheet_view_form" model="ir.ui.view">
        <field name="name">cost.sheet.view</field>
        <field name="model">cost.sheet</field>
        <field name="arch" type="xml">
            <form create="false">
                <header>
                    <button name="manually_create_task_or_production" string="Generate production manually" type="object" attrs="{'invisible': ['|', '|', ('sheet_type', 'in', ['design', 'purchase']), ('sale_state', 'in', ['draft']), ('production_state', 'in', ['progress', 'done'])]}"/>
                    <button name="manually_create_task_or_production" string="Generate tasks manually" type="object" attrs="{'invisible': ['|', '|', ('sheet_type', 'not in', ['design', 'purchase']), ('sale_state', 'in', ['draft']), ('production_state', 'in', ['progress', 'done'])]}"/>
                    <button name="manually_add_consumes" string="Generar consumo manual" type="object" attrs="{'invisible': ['|', '|', ('sheet_type', '!=', 'purchase'), ('sale_state', 'in', ['draft']), ('sheet_imprevist', '=',  True)]}"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    <group>
                        <group string="General">
                            <field name="can_edit" invisible="1"/>
                            <field name="sheet_type"/>
                            <field name="increment"/>
                            <field name="inspection_type"/>
                            <field name="description"/>
                            <field name="sheet_imprevist"/>
                            <field name="auto_ok_quality"/>
                        </group>
                        <group string="Modelos asociados">
                            <field name="sale_line_id"/>
                            <field name="sale_id"/>
                            <field name="group_id"/>
                            <field name="product_id"/>
                            <field name="production_id"/>
                            <field name="production_state"/>
                            <field name="sale_state"/>
                        </group>
                    </group>
                    <group string="Precios">
                        <group>
                                <field name="cost_init" attrs="{'invisible': [('sheet_type', 'in', ['dmls', 'unnplaned', 'meets'])]}"/>
                                <field name="cost_init_computed"  attrs="{'invisible': [('sheet_type', 'not in', ['dmls'])]}"/>
                                <field name="cost_ud" attrs="{'invisible': [('sheet_type', 'in', ['unnplaned', 'meets'])]}"/>
                                <field name="admin_fact" attrs="{'invisible': [('sheet_type', 'in', ['unnplaned', 'meets'])]}" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                <field name="use_disc_qty"  attrs="{'invisible': [('sheet_type', 'not in', ['fdm', 'sls', 'sls2', 'poly', 'sla', 'dmls'])]}"/> 

                        </group>
                        <group>
                                <!-- <field name="disc_qty" attrs="{'invisible': [('sheet_type', 'not in', ['design'])]}"/>  -->
                                <field name="disc_qty_computed" attrs="{'invisible': [('sheet_type', 'not in', ['fdm', 'sls', 'sls2', 'poly', 'sla', 'dmls'])]}"/>
                                <field name="disc2" attrs="{'invisible': [('sheet_type', 'not in', ['design'])]}"/>
                                <field name="increment" attrs="{'invisible': [('sheet_type', 'in', ['design', 'unnplaned', 'meets'])]}"/>
                                <field name="price_unit"  attrs="{'invisible': [('sheet_type', 'in', ['design', 'unnplaned', 'meets'])]}"/>
                                <field name="price_total"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Diseño" attrs="{'invisible': [('sheet_type', '!=', 'design')]}">
                            <group>
                                <group string="Datos pieza">
                                    <field name="flat_ref"/>
                                </group>
                                <!-- <group string="Carcterísticas pieza">
                                    <field name="feature_ids" nolabel="1" widget="many2many_checkboxes"/>
                                </group> -->
                                <group string="Legislación aplicable">
                                    <field name="legislation_ids" nolabel="1" widget="many2many_checkboxes"/>
                                </group>
                            </group>
                            <group string="Tiempos">
                                <field name="time_line_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="software_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="hours"/>
                                        <field name="price_hour" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="discount"/>
                                        <field name="total"/>
                                        <field name="task_id"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="design_total">
                                <field name="hours_total" widget='time'/>
                                <field name="amount_total" widget='monetary'/>
                            </group>
                        </page>

                        <page string="FDM" attrs="{'invisible': [('sheet_type', '!=', 'fdm')]}">
               
                            <group cospan="4" col="6" string="Datos pieza">
                                <field name="rpf"/>
                                <field name="cus_units"/>
                                <field name="cc_ud"/>
                                <field name="euros_cc"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group string="Carcterísticas pieza">
                                <field name="feature_ids" nolabel="1" widget="many2many_checkboxes"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group cospan="2" col="6" string="Parámetros impresión">
                                <field name="printer_id" domain="[('type', '=', sheet_type)]" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                <!-- <field name="printer_instance_id" domain="[('categ_id', '=', printer_id)]" options="{'no_create_edit': True, 'no_quick_create': True}"/> -->
                                <!-- <field name="perfil"/> -->
                                <field name="perfil_id" attrs="{'required': [('sheet_type', '=', 'fdm')]}" domain="[('printer_id', '=', printer_id)]" options="{'no_create': True, 'no_create_edit':True}" />
                                <field name="tray_units"/>
                                <field name="loops"/>
                                <field name="infill"/>
                                <field name="layer_height" readonly="1" force_save="1"/>
                                <field name="tray_hours"/>
                                <field name="euro_machine" groups="cost_sheet_lupeon.group_cs_advanced"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>

                            <!-- Vista custom tree por el nuevo filtro diametro en el campo matertial id -->
                            <group colspan="4" string="Material Cost">
                                <field name="material_cost_ids" nolabel="1" context="{'tree_view_ref': 'cost_sheet_lupeon.view_material_fdm'}"/>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="material_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="total_euro_ud" widget='monetary'/>
                                    <field name="total_material_cost" widget='monetary'/>
                            </group>
                            <group></group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="2" col="6" string="Coste Máquina">
                                <field name="machine_hours" widget="float_time"/>
                                <field name="euro_machine_ud"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                                <field name="euro_machine_total"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group string="Coste mano de obra">
                                <field name="workforce_cost_ids" readonly="1" force_save="1"  nolabel="1"/>
                            </group>
                             <group class="oe_subtotal_footer oe_right" colspan="2" name="wf_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="workforce_total_euro_ud" widget='monetary'/>
                                    <field name="workforce_total" widget='monetary'/>
                            </group>
                            <group></group>
                            <!-- <div style="border-bottom: 1px solid black;"></div>
                             <group colspan="4" string="Coste externalizacion por pieza">
                                <field name="outsorcing_cost_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="name"/>
                                        <field name="cost"/>
                                        <field name="margin"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="pvp"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="design_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="outsorcing_total_ud" widget='monetary'/>
                                    <field name="outsorcing_total" widget='monetary'/>
                            </group> -->
                            <div style="border-bottom: 1px solid black;"></div>
                            <group string="Otros consumos">
                                <field name="purchase_line_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="product_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="name"/>
                                        <field name="rfc"/>
                                        <field name="qty"/>
                                        <field name="partner_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="cost_ud"/>
                                        <field name="ports"/>
                                        <field name="margin"/>
                                        <field name="pvp_ud" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="pvp_total" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="meet_total" groups="cost_sheet_lupeon.group_cs_advanced">
                                <field name="purchase_total" widget='monetary'/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Oppi">
                                 <field name="oppi_line_ids" nolabel="1"/>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="material_total">
                                    <field name="total_oppi" widget='time'/>
                            </group>
                            
                        </page>

                        <!-- SLS P396 (ANTIGUO SLS)-->
                        <page string="SLS P396" attrs="{'invisible': [('sheet_type', '!=', 'sls')]}">
                            <group colspan="2" col="6" string="Datos pieza">
                                <field name="rpf"/>
                                <field name="cus_units"/>
                                <field name="x_mm_sls"/>
                                <field name="y_mm_sls"/>
                                <field name="z_mm_sls"/>
                                <field name="cc_ud"/>
                                <field name="tinted_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                <field name="cm2_sls"/>
                                <field name="e_cc_sls"/>
                            </group>
                             <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="2" col="6" string="Parámetros impresión">
                                <field name="printer_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                 <!-- <field name="printer_instance_id" domain="[('categ_id', '=', printer_id)]" options="{'no_create_edit': True, 'no_quick_create': True}"/> -->
                                <field name="tray_units"/>
                                <field name="print_increment" attrs="{'invisible': [('sheet_type', 'in', ['poly'])], 'readonly': [('can_edit', '!=', True)]}"/>
                                <field name="tray_hours_sls"/>
                                <field name="euro_machine"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                            </group>
                             <div style="border-bottom: 1px solid black;"></div>
                             <group colspan="2" col="6" string="Configuración oferta">
                                <field name="offer_type"/>
                                <field name="solid_per_sls"/>
                                <field name="bucket_height_sls"/>
                                <field name="simulation_time_sls"/>
                            </group>
                             <div style="border-bottom: 1px solid black;"></div>
                             <group colspan="4" string="Material Cost">
                                 <field name="material_cost_ids" nolabel="1"/>
                            </group>
                             <group class="oe_subtotal_footer oe_right" colspan="2" name="material_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="total_euro_ud" widget='monetary'/>
                                    <field name="total_material_cost" widget='monetary'/>
                            </group>
                            <group></group>
                             <div style="border-bottom: 1px solid black;"></div>
                             <group colspan="2" col="6" string="Coste Máquina">
                                <field name="machine_hours" widget="float_time"/>
                                <field name="euro_machine_ud" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                <field name="euro_machine_total" groups="cost_sheet_lupeon.group_cs_advanced"/>
                            </group>
                             <div style="border-bottom: 1px solid black;"></div>
                             <group string="Coste mano de obra">
                                <field name="workforce_cost_ids" readonly="1" force_save="1"  nolabel="1"/>
                            </group>
                             <group class="oe_subtotal_footer oe_right" colspan="2" name="wf_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="workforce_total_euro_ud" widget='monetary'/>
                                    <field name="workforce_total" widget='monetary'/>
                            </group>
                            <group></group>
                            <!-- <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Coste externalizacion por pieza">
                                <field name="outsorcing_cost_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="name"/>
                                        <field name="cost"/>
                                        <field name="margin"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="pvp"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="design_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="outsorcing_total_ud" widget='monetary'/>
                                    <field name="outsorcing_total" widget='monetary'/>
                            </group>
                            <group></group> -->
                            <div style="border-bottom: 1px solid black;"></div>
                            <group string="Otros consumos">
                                <field name="purchase_line_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="product_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="name"/>
                                        <field name="rfc"/>
                                        <field name="qty"/>
                                        <field name="partner_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="cost_ud"/>
                                        <field name="ports"/>
                                        <field name="margin"/>
                                        <field name="pvp_ud" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="pvp_total" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="meet_total" groups="cost_sheet_lupeon.group_cs_advanced">
                                <field name="purchase_total" widget='monetary'/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Oppi">
                                 <field name="oppi_line_ids" nolabel="1"/>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="material_total">
                                    <field name="total_oppi" widget='time'/>
                            </group>
                        </page>
                    

                        <!-- POLY -->
                         <page string="POLY" attrs="{'invisible': [('sheet_type', '!=', 'poly')]}">
                            <group colspan="2" col="6" string="Datos pieza">
                                <field name="rpf"/>
                                <field name="cus_units"/>
                                <field name="cc_ud"/>
                                <field name="euros_cc"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="2" col="6" string="Parámetros impresión">
                                <field name="printer_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                <!-- <field name="printer_instance_id" domain="[('categ_id', '=', printer_id)]" options="{'no_create_edit': True, 'no_quick_create': True}"/> -->
                                <field name="tray_units"/>
                                <field name="finish_pol"/>
                                <field name="tray_hours"/>
                                <field name="euro_machine" groups="cost_sheet_lupeon.group_cs_advanced"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Material Cost">
                                 <field name="material_cost_ids" nolabel="1"/>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="material_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="total_euro_ud" widget='monetary'/>
                                    <field name="total_material_cost" widget='monetary'/>
                            </group>
                            <group></group>
                            <div style="border-bottom: 1px solid black;"></div>
                             <group colspan="2" col="6" string="Coste Máquina">
                                <field name="machine_hours" widget="float_time"/>
                                <field name="euro_machine_ud" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                <field name="euro_machine_total" groups="cost_sheet_lupeon.group_cs_advanced"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                             <group string="Coste mano de obra">
                                <field name="workforce_cost_ids" readonly="1" force_save="1"  nolabel="1"/>
                            </group>
                             <group class="oe_subtotal_footer oe_right" colspan="2" name="wf_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="workforce_total_euro_ud" widget='monetary'/>
                                    <field name="workforce_total" widget='monetary'/>
                            </group>
                            <group></group>
                            <!-- <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Coste externalizacion por pieza">
                                <field name="outsorcing_cost_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="name"/>
                                        <field name="cost"/>
                                        <field name="margin"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="pvp"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="design_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="outsorcing_total_ud" widget='monetary'/>
                                    <field name="outsorcing_total" widget='monetary'/>
                            </group>
                            <group></group> -->
                            <div style="border-bottom: 1px solid black;"></div>
                            <group string="Otros consumos">
                                <field name="purchase_line_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="product_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="name"/>
                                        <field name="rfc"/>
                                        <field name="qty"/>
                                        <field name="partner_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="cost_ud"/>
                                        <field name="ports"/>
                                        <field name="margin"/>
                                        <field name="pvp_ud" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="pvp_total" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="meet_total" groups="cost_sheet_lupeon.group_cs_advanced">
                                <field name="purchase_total" widget='monetary'/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Oppi">
                                 <field name="oppi_line_ids" nolabel="1"/>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="material_total">
                                    <field name="total_oppi" widget='time'/>
                            </group>
                        </page>

                         <!-- SLA -->
                         <page string="SLA" attrs="{'invisible': [('sheet_type', '!=', 'sla')]}">
                            <group colspan="2" col="6" string="Datos pieza">
                                 <field name="rpf"/>
                                <field name="cus_units"/>
                                <field name="cc_ud"/>
                                <field name="euros_cc"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="2" col="6" string="Parámetros impresión">
                                <field name="printer_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                <!-- <field name="printer_instance_id" options="{'no_create_edit': True, 'no_quick_create': True}" domain="[('categ_id', '=', printer_id)]"/> -->
                                <field name="tray_units"/>
                                <field name="tray_hours"/>
                                <field name="euro_machine" groups="cost_sheet_lupeon.group_cs_advanced"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                             <group colspan="4" string="Material Cost">
                                 <field name="material_cost_ids" nolabel="1"/>
                            </group>
                             <group class="oe_subtotal_footer oe_right" colspan="2" name="material_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="total_euro_ud" widget='monetary'/>
                                    <field name="total_material_cost" widget='monetary'/>
                            </group>
                            <group></group>
                            <div style="border-bottom: 1px solid black;"></div>
                             <group colspan="2" col="6" string="Coste Máquina">
                                <field name="machine_hours" widget="float_time"/>
                                <field name="euro_machine_ud" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                <field name="euro_machine_total" groups="cost_sheet_lupeon.group_cs_advanced"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group string="Coste mano de obra">
                                <field name="workforce_cost_ids" readonly="1" force_save="1"  nolabel="1"/>
                            </group>
                             <group class="oe_subtotal_footer oe_right" colspan="2" name="wf_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="workforce_total_euro_ud" widget='monetary'/>
                                    <field name="workforce_total" widget='monetary'/>
                            </group>
                            <group></group>
                            <!-- <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Coste externalizacion por pieza">
                                <field name="outsorcing_cost_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="name"/>
                                        <field name="cost"/>
                                        <field name="margin"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="pvp"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="design_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="outsorcing_total_ud" widget='monetary'/>
                                    <field name="outsorcing_total" widget='monetary'/>
                            </group>
                            <group></group> -->
                            <div style="border-bottom: 1px solid black;"></div>
                            <group string="Otros consumos">
                                <field name="purchase_line_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="product_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="name"/>
                                        <field name="rfc"/>
                                        <field name="qty"/>
                                        <field name="partner_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="cost_ud"/>
                                        <field name="ports"/>
                                        <field name="margin"/>
                                        <field name="pvp_ud" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="pvp_total" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="meet_total" groups="cost_sheet_lupeon.group_cs_advanced">
                                <field name="purchase_total" widget='monetary'/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Oppi">
                                 <field name="oppi_line_ids" nolabel="1"/>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="material_total">
                                    <field name="total_oppi" widget='time'/>
                            </group>
                        </page>

                        <!-- SLS (igual a SLA, y el anterior SLS pasa a ser SLS P396) -->
                         <page string="SLS" attrs="{'invisible': [('sheet_type', '!=', 'sls2')]}">
                            <group colspan="2" col="6" string="Datos pieza">
                                 <field name="rpf"/>
                                <field name="cus_units"/>
                                <field name="cc_ud"/>
                                <field name="euros_cc"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="2" col="6" string="Parámetros impresión">
                                <field name="printer_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                <!-- <field name="printer_instance_id" domain="[('categ_id', '=', printer_id)]" options="{'no_create_edit': True, 'no_quick_create': True}"/> -->
                                <field name="tray_units"/>
                                <field name="tray_hours"/>
                                <field name="euro_machine" groups="cost_sheet_lupeon.group_cs_advanced"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                             <group colspan="4" string="Material Cost">
                                 <field name="material_cost_ids" nolabel="1"/>
                            </group>
                             <group class="oe_subtotal_footer oe_right" colspan="2" name="material_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="total_euro_ud" widget='monetary'/>
                                    <field name="total_material_cost" widget='monetary'/>
                            </group>
                            <group></group>
                            <div style="border-bottom: 1px solid black;"></div>
                             <group colspan="2" col="6" string="Coste Máquina">
                                <field name="machine_hours" widget="float_time"/>
                                <field name="euro_machine_ud" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                <field name="euro_machine_total" groups="cost_sheet_lupeon.group_cs_advanced"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group string="Coste mano de obra">
                                <field name="workforce_cost_ids" readonly="1" force_save="1"  nolabel="1"/>
                            </group>
                             <group class="oe_subtotal_footer oe_right" colspan="2" name="wf_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="workforce_total_euro_ud" widget='monetary'/>
                                    <field name="workforce_total" widget='monetary'/>
                            </group>
                            <group></group>
                            <!-- <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Coste externalizacion por pieza">
                                <field name="outsorcing_cost_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="name"/>
                                        <field name="cost"/>
                                        <field name="margin"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="pvp"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="design_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="outsorcing_total_ud" widget='monetary'/>
                                    <field name="outsorcing_total" widget='monetary'/>
                            </group>
                            <group></group> -->
                            <div style="border-bottom: 1px solid black;"></div>
                            <group string="Otros consumos">
                                <field name="purchase_line_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="product_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="name"/>
                                        <field name="rfc"/>
                                        <field name="qty"/>
                                        <field name="partner_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="cost_ud"/>
                                        <field name="ports"/>
                                        <field name="margin"/>
                                        <field name="pvp_ud" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="pvp_total" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="meet_total" groups="cost_sheet_lupeon.group_cs_advanced">
                                <field name="purchase_total" widget='monetary'/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Oppi">
                                 <field name="oppi_line_ids" nolabel="1"/>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="material_total">
                                    <field name="total_oppi" widget='time'/>
                            </group>
                        </page>

                         <!-- DMLS -->
                        <page string="DMLS" attrs="{'invisible': [('sheet_type', '!=', 'dmls')]}">
                            <group colspan="2" col="6" string="Datos pieza">
                                 <field name="rpf"/>
                                <field name="cus_units"/>
                                <field name="cc_ud"/>
                                <field name="cc_soport_dmls"/>
                                <field name="euros_cc"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="2" col="6" string="Parámetros impresión">
                                <field name="printer_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                <!-- <field name="printer_instance_id" domain="[('categ_id', '=', printer_id)]" options="{'no_create_edit': True, 'no_quick_create': True}"/> -->
                                <field name="tray_units"/>
                                <field name="tray_hours"/>
                                <field name="euro_machine" groups="cost_sheet_lupeon.group_cs_advanced"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Material Cost">
                                 <field name="material_cost_ids" nolabel="1"/>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="material_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="total_euro_ud" widget='monetary'/>
                                    <field name="total_material_cost" widget='monetary'/>
                            </group>
                            <group colspan="4">
                                 <field name="use_treatment"/>
                                 <field name="heat_treatment_cost"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="2" col="6" string="Coste Máquina">
                                <field name="machine_hours" widget="float_time"/>
                                <field name="euro_machine_ud" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                <field name="euro_machine_total" groups="cost_sheet_lupeon.group_cs_advanced"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group string="Coste mano de obra">
                                <field name="workforce_cost_ids" readonly="1" force_save="1"  nolabel="1"/>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="wf_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="workforce_total_euro_ud" widget='monetary'/>
                                    <field name="workforce_total" widget='monetary'/>
                            </group>
                            <group></group>
                            <!-- <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Coste externalizacion por pieza">
                                <field name="outsorcing_cost_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="name"/>
                                        <field name="cost"/>
                                        <field name="margin"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="pvp"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="out_total"  groups="cost_sheet_lupeon.group_cs_advanced">
                                    <field name="outsorcing_total_ud" widget='monetary'/>
                                    <field name="outsorcing_total" widget='monetary'/>
                            </group>
                            <group></group> -->
                            <div style="border-bottom: 1px solid black;"></div>
                            <group string="Otros consumos">
                                <field name="purchase_line_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="product_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="name"/>
                                        <field name="rfc"/>
                                        <field name="qty"/>
                                        <field name="partner_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="cost_ud"/>
                                        <field name="ports"/>
                                        <field name="margin"/>
                                        <field name="pvp_ud" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="pvp_total" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="meet_total" groups="cost_sheet_lupeon.group_cs_advanced">
                                <field name="purchase_total" widget='monetary'/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Oppi">
                                 <field name="oppi_line_ids" nolabel="1"/>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="material_total">
                                    <field name="total_oppi" widget='time'/>
                            </group>
                        </page>

                        <page string="Imprevistos" attrs="{'invisible': [('sheet_type', '!=', 'unplanned')]}">
                            <group>
                                <field name="unplanned_cost"/>
                            </group>
                        </page>

                        <page string="Reuniones" attrs="{'invisible': [('sheet_type', '!=', 'meets')]}">
                            <group string="Reuniones">
                                <field name="meet_line_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="name"/>
                                        <field name="task_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="type" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="num_people"/>
                                        <field name="hours"/>
                                        <field name="kms"/>
                                        <field name="diets"/>
                                        <field name="pvp" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="meet_total">
                                <field name="meet_hours_total" widget='time'/>
                                <field name="meet_total" widget='monetary' groups="cost_sheet_lupeon.group_cs_advanced"/>
                            </group>
                        </page>

                        <page string="Compras" attrs="{'invisible': [('sheet_type', '!=', 'purchase')]}">
                            <group string="Otros consumos">
                                <field name="purchase_line_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="product_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="name"/>
                                        <field name="rfc" string="RPC"/>
                                        <field name="qty"/>
                                        <field name="partner_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="cost_ud"/>
                                        <field name="ports"/>
                                        <field name="margin"/>
                                        <field name="pvp_ud" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                        <field name="pvp_total" groups="cost_sheet_lupeon.group_cs_advanced"/>
                                    </tree>
                                </field>
                            </group>
                            <group class="oe_subtotal_footer oe_right" colspan="2" name="meet_total" groups="cost_sheet_lupeon.group_cs_advanced">
                                <field name="purchase_total" widget='monetary'/>
                            </group>
                        </page>



                    </notebook>
                   
                   
                </sheet>
            </form>
        </field>
    </record>

     <record id="simple_cost_sheet_view_form" model="ir.ui.view">
        <field name="name">cost.sheet.view</field>
        <field name="model">cost.sheet</field>
        <field name="arch" type="xml">
            <form create="false">
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    <group>
                        <group string="General">
                            <field name="can_edit" invisible="1"/>
                            <field name="sheet_type"/>
                            <field name="description"/>
                        </group>
                    </group>
                  
                    <notebook>
                        <page string="Diseño" attrs="{'invisible': [('sheet_type', '!=', 'design')]}">
                            <group>
                                <group string="Datos pieza">
                                    <field name="flat_ref"/>
                                </group>
                              
                                <group string="Legislación aplicable">
                                    <field name="legislation_ids" nolabel="1" widget="many2many_checkboxes"/>
                                </group>
                            </group>
                            <group string="Tiempos">
                                <field name="time_line_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="software_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="hours"/>
                                      
                                        <field name="task_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                    </tree>
                                </field>
                            </group>
                          
                        </page>

                        <page string="FDM" attrs="{'invisible': [('sheet_type', '!=', 'fdm')]}">
               
                            <group cospan="4" col="6" string="Datos pieza">
                                <field name="rpf"/>
                                <field name="cus_units"/>
                                <field name="cc_ud"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group string="Carcterísticas pieza">
                                <field name="feature_ids" nolabel="1" widget="many2many_checkboxes"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group cospan="2" col="6" string="Parámetros impresión">
                                <field name="printer_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                 <!-- <field name="printer_instance_id" domain="[('categ_id', '=', printer_id)]" options="{'no_create_edit': True, 'no_quick_create': True}"/> -->
                                <!-- <field name="perfil"/> -->
                                <field name="perfil_id" attrs="{'required': [('sheet_type', '=', 'fdm')]}" domain="[('printer_id', '=', printer_id)]" options="{'no_create': True, 'no_create_edit':True}" />
                                <field name="tray_units"/>
                                <field name="layer_height" readonly="1" force_save="1"/>
                                <field name="loops"/>
                                <field name="infill"/>
                                <field name="tray_hours"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>

                             <group colspan="4" string="Material Cost">
                                 <field name="material_cost_ids" nolabel="1"/>
                            </group>
                           
                            <group></group>
                            <div style="border-bottom: 1px solid black;"></div>
                         
                            
                        </page>

                        <!-- SLS P396 (ANTIGUO SLS)-->
                        <page string="SLS P396" attrs="{'invisible': [('sheet_type', '!=', 'sls')]}">
                            <group colspan="2" col="6" string="Datos pieza">
                                <field name="rpf"/>
                                <field name="cus_units"/>
                                <field name="x_mm_sls"/>
                                <field name="y_mm_sls"/>
                                <field name="z_mm_sls"/>
                                <field name="cc_ud"/>
                                <field name="tinted_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                <field name="cm2_sls"/>
                            </group>
                             <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="2" col="6" string="Parámetros impresión">
                                <field name="printer_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                 <!-- <field name="printer_instance_id" domain="[('categ_id', '=', printer_id)]" options="{'no_create_edit': True, 'no_quick_create': True}"/> -->
                                <field name="tray_units"/>
                                <field name="print_increment" attrs="{'invisible': [('sheet_type', 'in', ['poly'])], 'readonly': [('can_edit', '!=', True)]}"/>
                                <field name="tray_hours_sls"/>
                            </group>
                             <div style="border-bottom: 1px solid black;"></div>
                         
                             <group colspan="4" string="Material Cost">
                                 <field name="material_cost_ids" nolabel="1"/>
                            </group>
                          
                            <group></group>
                             <div style="border-bottom: 1px solid black;"></div>
                             
                        </page>
                    

                        <!-- POLY -->
                         <page string="POLY" attrs="{'invisible': [('sheet_type', '!=', 'poly')]}">
                            <group colspan="2" col="6" string="Datos pieza">
                                <field name="rpf"/>
                                <field name="cus_units"/>
                                <field name="cc_ud"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="2" col="6" string="Parámetros impresión">
                                <field name="printer_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                 <!-- <field name="printer_instance_id" domain="[('categ_id', '=', printer_id)]" options="{'no_create_edit': True, 'no_quick_create': True}"/> -->
                                <field name="tray_units"/>
                                <field name="finish_pol"/>
                                <field name="tray_hours"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Material Cost">
                                 <field name="material_cost_ids" nolabel="1"/>
                            </group>

                            <group></group>
                            <div style="border-bottom: 1px solid black;"></div>
                        </page>

                         <!-- SLA -->
                         <page string="SLA" attrs="{'invisible': [('sheet_type', '!=', 'sla')]}">
                            <group colspan="2" col="6" string="Datos pieza">
                                <field name="rpf"/>
                                <field name="cus_units"/>
                                <field name="cc_ud"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="2" col="6" string="Parámetros impresión">
                                <field name="printer_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                 <!-- <field name="printer_instance_id" domain="[('categ_id', '=', printer_id)]" options="{'no_create_edit': True, 'no_quick_create': True}"/> -->
                                <field name="tray_units"/>
                                <field name="tray_hours"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                             <group colspan="4" string="Material Cost">
                                 <field name="material_cost_ids" nolabel="1"/>
                            </group>
                            <group></group>
                            <div style="border-bottom: 1px solid black;"></div>
                           
                        </page>

                        <!-- SLS (igual a SLA, y el anterior SLS pasa a ser SLS P396) -->
                         <page string="SLS" attrs="{'invisible': [('sheet_type', '!=', 'sls2')]}">
                            <group colspan="2" col="6" string="Datos pieza">
                                <field name="rpf"/>
                                <field name="cus_units"/>
                                <field name="cc_ud"/>
                                <field name="euros_cc"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="2" col="6" string="Parámetros impresión">
                                <field name="printer_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                 <!-- <field name="printer_instance_id" domain="[('categ_id', '=', printer_id)]" options="{'no_create_edit': True, 'no_quick_create': True}"/> -->
                                <field name="tray_units"/>
                                <field name="tray_hours"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                             <group colspan="4" string="Material Cost">
                                 <field name="material_cost_ids" nolabel="1"/>
                            </group>
                        
                            <group></group>
                            <div style="border-bottom: 1px solid black;"></div>
                           
                        </page>

                         <!-- DMLS -->
                        <page string="DMLS" attrs="{'invisible': [('sheet_type', '!=', 'dmls')]}">
                            <group colspan="2" col="6" string="Datos pieza">
                                <field name="rpf"/>
                                <field name="cus_units"/>
                                <field name="cc_ud"/>
                                <field name="cc_soport_dmls"/>
                                <field name="euros_cc"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="2" col="6" string="Parámetros impresión">
                                <field name="printer_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                <!-- <field name="printer_instance_id" domain="[('categ_id', '=', printer_id)]" options="{'no_create_edit': True, 'no_quick_create': True}"/> -->
                                <field name="tray_units"/>
                                <field name="tray_hours"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                            <group colspan="4" string="Material Cost">
                                 <field name="material_cost_ids" nolabel="1"/>
                            </group>
                          
                            <group colspan="4">
                                 <field name="use_treatment"/>
                                 <field name="heat_treatment_cost"/>
                            </group>
                            <div style="border-bottom: 1px solid black;"></div>
                           
                        </page>

                        <page string="Imprevistos" attrs="{'invisible': [('sheet_type', '!=', 'unplanned')]}">
                            <group>
                                <field name="unplanned_cost"/>
                            </group>
                        </page>

                        <page string="Reuniones" attrs="{'invisible': [('sheet_type', '!=', 'meets')]}">
                            <group string="Reuniones">
                                <field name="meet_line_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="name"/>
                                        <field name="type" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="num_people"/>
                                        <field name="hours"/>
                                        <field name="kms"/>
                                    </tree>
                                </field>
                            </group>
                           
                        </page>

                        <page string="Compras" attrs="{'invisible': [('sheet_type', '!=', 'purchase')]}">
                            <group string="Otros consumos">
                                <field name="purchase_line_ids" nolabel="1">
                                    <tree editable="bottom">
                                        <field name="product_id" options="{'no_create_edit': True, 'no_quick_create': True}"/>
                                        <field name="name"/>
                                        <field name="qty"/>
                                        <field name="partner_id"/>
                                        <field name="ports"/>
                                        <field name="margin"/>
                                      
                                    </tree>
                                </field>
                            </group>
                        </page>



                    </notebook>
                   
                   
                </sheet>
            </form>
        </field>
    </record>

     <!-- Vistas de campos One2many -->
    <record id="view_material_fdm" model="ir.ui.view">
        <field name="name">cost_materual_line_view_tree</field>
        <field name="model">material.cost.line</field>
        <field name="arch" type="xml">
            <tree editable="bottom">
                <field name="can_edit" invisible="1"/>
                <field name="name"/>
                <field name="available_material_ids" invisible="1"/>
                <field name="material_id" domain="[('id', 'in', available_material_ids), ('is_material', '=', True), ('material_type', '=', parent.sheet_type), ('diameter', '=', diameter)]"/>
                <!-- FDM FIELDS -->
                <field name="diameter" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/>
                <!-- <field name="color" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/> -->
                <field name="tray_meters" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/>
                <field name="gr_cc_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/>
                <field name="gr_cc_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/>

                <!-- SLS P396 fields -->
                <field name="sls_gr_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sls')]}"/>
                <field name="sls_gr_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sls')]}"/>

                <!--Poly fields -->
                <field name="pol_gr_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'poly')]}"/>
                <!--SLA fields -->
                <field name="sla_cc_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sla')]}"/>
                <!--SLS fields -->
                <field name="sls2_cc_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sls2')]}"/>
                <!--DMLS fields -->
                <field name="dmls_cc_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'dmls')]}"/>
                
                <field name="desviation" attrs="{'column_invisible': [('parent.sheet_type', 'not in', ['poly', 'sla', 'sls2', 'dmls'])], 'readonly': [('can_edit', '!=', True)]}"/>
                <!--Poly fields -->
                <field name="pol_gr_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'poly')]}"/>
                <!--SLA fields -->
                <field name="sla_cc_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sla')]}"/>
                <!--SLS fields -->
                <field name="sls2_cc_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sls2')]}"/>
                <!--DMLS fields -->
                <field name="dmls_cc_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'dmls')]}"/>

                <field name="euro_material"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                <field name="total" attrs="{'column_invisible': [('parent.sheet_type', '=', 'fdm')]}"  groups="cost_sheet_lupeon.group_cs_advanced"/>
            </tree>
        </field>
    </record>

    <record id="cost_material_line_view_tree" model="ir.ui.view">
        <field name="name">cost_materual_line_view_tree</field>
        <field name="model">material.cost.line</field>
        <field name="arch" type="xml">
            <tree editable="bottom">
                <field name="can_edit" invisible="1"/>
                <field name="name"/>
                <field name="available_material_ids" invisible="1"/>
                <field name="material_id" attrs="{'column_invisible': [('parent.sheet_type', '=', 'fdm')]}" domain="[('id', 'in', available_material_ids), ('is_material', '=', True), ('material_type', '=', parent.sheet_type)]"/>
                    <field name="material_id2" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}" domain="[('id', 'in', available_material_ids), ('is_material', '=', True), ('material_type', '=', parent.sheet_type), ('diameter', '=', diameter)]"/>
                <!-- FDM FIELDS -->
                <field name="diameter" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/>
                <!-- <field name="color" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/> -->
                <field name="tray_meters" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/>
                <field name="gr_cc_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/>
                <field name="gr_cc_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/>

                <!-- SLS P396 fields -->
                <field name="sls_gr_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sls')]}"/>
                <field name="sls_gr_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sls')]}"/>

                <!--Poly fields -->
                <field name="pol_gr_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'poly')]}"/>
                <!--SLA fields -->
                <field name="sla_cc_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sla')]}"/>
                <!--SLS fields -->
                <field name="sls2_cc_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sls2')]}"/>
                <!--DMLS fields -->
                <field name="dmls_cc_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'dmls')]}"/>
                
                <field name="desviation" attrs="{'column_invisible': [('parent.sheet_type', 'not in', ['poly', 'sla', 'sls2', 'dmls'])], 'readonly': [('can_edit', '!=', True)]}"/>
                <!--Poly fields -->
                <field name="pol_gr_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'poly')]}"/>
                <!--SLA fields -->
                <field name="sla_cc_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sla')]}"/>
                <!--SLS fields -->
                <field name="sls2_cc_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sls2')]}"/>
                <!--DMLS fields -->
                <field name="dmls_cc_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'dmls')]}"/>

                <field name="euro_material"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                <field name="total" attrs="{'column_invisible': [('parent.sheet_type', '=', 'fdm')]}"  groups="cost_sheet_lupeon.group_cs_advanced"/>
            </tree>
        </field>
    </record>

    <record id="cost_material_line_view_form" model="ir.ui.view">
        <field name="name">cost_materual_line_view_form</field>
        <field name="model">material.cost.line</field>
        <field name="arch" type="xml">
            <form>
                <group col="2">
                    <field name="can_edit" invisible="1"/>
                    <field name="name"/>
                    <field name="name"/>
                    <field name="available_material_ids" invisible="0"/>
                    <field name="material_id" options="{'no_create_edit': True, 'no_quick_create': True}" attrs="{'column_invisible': [('parent.sheet_type', '=', 'fdm')]}" domain="[('id', 'in', available_material_ids), ('is_material', '=', True), ('material_type', '=', parent.sheet_type)]"/>
                    <field name="material_id2" options="{'no_create_edit': True, 'no_quick_create': True}" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}" domain="[('id', 'in', available_material_ids), ('is_material', '=', True), ('material_type', '=', parent.sheet_type), ('diameter', '=', diameter)]"/>
                    <!-- FDM FIELDS -->
                    <field name="diameter" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/>
                    <!-- <field name="color" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/> -->
                    <field name="tray_meters" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/>
                    <field name="gr_cc_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/>
                    <field name="gr_cc_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'fdm')]}"/>

                    <!-- SLS P396 fields -->
                    <field name="sls_gr_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sls')]}"/>
                    <field name="sls_gr_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sls')]}"/>

                    <!--Poly fields -->
                    <field name="pol_gr_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'poly')]}"/>
                    <!--SLA fields -->
                    <field name="sla_cc_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sla')]}"/>
                    <!--SLS fields -->
                    <field name="sls2_cc_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sls2')]}"/>
                    <!--DMLS fields -->
                    <field name="dmls_cc_tray" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'dmls')]}"/>
                    
                    <field name="desviation" attrs="{'column_invisible': [('parent.sheet_type', 'not in', ['poly', 'sla', 'sls2', 'dmls'])], 'readonly': [('can_edit', '!=', True)]}"/>
                    <!--Poly fields -->
                    <field name="pol_gr_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'poly')]}"/>
                    <!--SLA fields -->
                    <field name="sla_cc_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sla')]}"/>
                    <!--SLS fields -->
                    <field name="sls2_cc_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'sls2')]}"/>
                    <!--DMLS fields -->
                    <field name="dmls_cc_total" attrs="{'column_invisible': [('parent.sheet_type', '!=', 'dmls')]}"/>

                    <field name="euro_material"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                    <field name="total" attrs="{'column_invisible': [('parent.sheet_type', '=', 'fdm')]}"  groups="cost_sheet_lupeon.group_cs_advanced"/>
                </group>
            </form>
        </field>
    </record>



</odoo>